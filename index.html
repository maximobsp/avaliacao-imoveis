<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avaliação de Imóveis - Maximob</title>
    <style>
        /* Reset básico */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Variáveis de cores */
        :root {
            --primary: #0056b3;
            --primary-dark: #004494;
            --secondary: #f8f9fa;
            --text: #333333;
            --text-light: #6c757d;
            --border: #dee2e6;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
        }
        
        /* Estilos gerais */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.5;
            color: var(--text);
            background-color: #f5f5f5;
            min-height: 100vh;
        }
        
        .container {
            width: 100%;
            max-width: 1140px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        /* Cabeçalho e logo */
        .header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .logo {
            max-height: 64px;
            width: auto;
            transition: opacity 0.3s;
        }
        
        .logo:hover {
            opacity: 0.8;
        }
        
        /* Cartão principal */
        .card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        /* Títulos */
        h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text);
            text-align: center;
        }
        
        h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text);
        }
        
        h3 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }
        
        /* Texto */
        p {
            margin-bottom: 1rem;
        }
        
        .text-center {
            text-align: center;
        }
        
        .text-muted {
            color: var(--text-light);
            font-size: 0.875rem;
        }
        
        /* Seções do formulário */
        .form-section {
            background-color: var(--secondary);
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        /* Grid para layout responsivo */
        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        @media (min-width: 768px) {
            .grid-2 {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .grid-3 {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .span-2 {
                grid-column: span 2;
            }
        }
        
        /* Formulários */
        .form-group {
            margin-bottom: 1rem;
        }
        
        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.25rem;
        }
        
        .required::after {
            content: "*";
            color: var(--danger);
            margin-left: 0.25rem;
        }
        
        input[type="text"],
        input[type="tel"],
        input[type="email"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 0.5rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            color: var(--text);
            background-color: #fff;
            border: 1px solid var(--border);
            border-radius: 0.25rem;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        
        input:focus,
        select:focus,
        textarea:focus {
            border-color: var(--primary);
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(0, 86, 179, 0.25);
        }
        
        select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 16px 12px;
            padding-right: 2rem;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        input[type="checkbox"] {
            margin-right: 0.5rem;
            width: 1rem;
            height: 1rem;
        }
        
        /* Botões */
        .btn {
            display: inline-block;
            font-weight: 500;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            user-select: none;
            border: 1px solid transparent;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 0.375rem;
            transition: all 0.15s ease-in-out;
            cursor: pointer;
        }
        
        .btn-primary {
            color: #fff;
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .btn-primary:disabled {
            opacity: 0.65;
            cursor: not-allowed;
        }
        
        .btn-block {
            display: block;
            width: 100%;
        }
        
        /* Resultados */
        .result-card {
            background-color: white;
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .result-value {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        /* Alertas */
        .alert {
            position: relative;
            padding: 0.75rem 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: 0.25rem;
        }
        
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
            border-left: 4px solid #17a2b8;
        }
        
        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
            border-left: 4px solid #dc3545;
        }
        
        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-left-color: var(--primary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Rodapé */
        .footer {
            margin-top: 2rem;
            text-align: center;
            font-size: 0.875rem;
            color: var(--text-light);
        }
        
        .footer a {
            color: var(--primary);
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        /* Utilitários */
        .hidden {
            display: none;
        }
        
        .mt-4 {
            margin-top: 1rem;
        }
        
        .mb-4 {
            margin-bottom: 1rem;
        }
        
        .text-center {
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Overlay de carregamento -->
    <div id="loading" class="loading-overlay hidden">
        <div class="spinner"></div>
    </div>

    <div class="container">
        <div class="card">
            <!-- Cabeçalho e logo -->
            <div class="header">
                <a href="https://www.robinsonimoveis.com.br" target="_blank" rel="noopener noreferrer">
                    <img src="https://robinsonimoveis.com.br/wp-content/uploads/2023/09/logo-maximob.png" alt="Maximob Logo" class="logo">
                </a>
                <h1>Avaliação de Imóveis</h1>
                <p class="text-muted">Informe os dados abaixo para receber uma estimativa de valor baseada em imóveis similares</p>
            </div>

            <!-- Formulário -->
            <form id="avaliacaoForm" action="https://formsubmit.co/robinson@maximob.com.br" method="POST">
                <!-- Campos ocultos para FormSubmit.co -->
                <input type="hidden" name="_subject" value="Nova Avaliação de Imóvel - Maximob">
                <input type="hidden" name="_template" value="table">
                <input type="hidden" name="_captcha" value="false">
                <input type="hidden" name="_next" value="https://robinsonimoveis.com.br/obrigado">
                
                <!-- Dados do Solicitante -->
                <div class="form-section">
                    <h2>Dados do Solicitante</h2>
                    <div class="grid grid-2">
                        <div class="form-group">
                            <label for="nome" class="required">Nome Completo</label>
                            <input type="text" id="nome" name="nome" required>
                        </div>
                        <div class="form-group">
                            <label for="telefone" class="required">Telefone</label>
                            <input type="tel" id="telefone" name="telefone" required>
                        </div>
                        <div class="form-group span-2">
                            <label for="email">E-mail</label>
                            <input type="email" id="email" name="email">
                        </div>
                    </div>
                </div>

                <!-- Dados do Imóvel -->
                <div class="form-section">
                    <h2>Dados do Imóvel</h2>
                    <div class="grid grid-2">
                        <div class="form-group">
                            <label for="tipoImovel" class="required">Tipo de Imóvel</label>
                            <select id="tipoImovel" name="tipoImovel" required>
                                <option value="">Selecione...</option>
                                <option value="Casa">Casa</option>
                                <option value="Apartamento">Apartamento</option>
                                <option value="Terreno">Terreno</option>
                                <option value="Chácara">Chácara</option>
                                <option value="Sítio">Sítio</option>
                                <option value="Sobrado">Sobrado</option>
                                <option value="Prédio">Prédio</option>
                                <option value="Área Empreendimento">Área Empreendimento</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="cidade" class="required">Cidade</label>
                            <select id="cidade" name="cidade" required>
                                <option value="">Selecione...</option>
                                <option value="Itapira">Itapira</option>
                                <option value="Campinas">Campinas</option>
                                <option value="Jacutinga">Jacutinga</option>
                                <option value="Amparo">Amparo</option>
                                <option value="Mogi Mirim">Mogi Mirim</option>
                                <option value="Serra Negra">Serra Negra</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="bairro" class="required">Bairro</label>
                            <input type="text" id="bairro" name="bairro" required>
                        </div>
                        <div class="form-group">
                            <label for="endereco" class="required">Endereço Completo</label>
                            <input type="text" id="endereco" name="endereco" required>
                        </div>
                        <div class="form-group">
                            <label for="areaConstruida" class="required">Área Construída (m²)</label>
                            <input type="number" id="areaConstruida" name="areaConstruida" required min="1">
                        </div>
                        <div class="form-group">
                            <label for="areaTerreno">Área do Terreno (m²)</label>
                            <input type="number" id="areaTerreno" name="areaTerreno" min="1">
                        </div>
                    </div>
                </div>

                <!-- Detalhes Adicionais -->
                <div class="form-section">
                    <h2>Detalhes Adicionais (Opcional)</h2>
                    <div class="grid grid-3">
                        <div class="form-group">
                            <label for="dormitorios">Dormitórios</label>
                            <input type="number" id="dormitorios" name="dormitorios" min="0">
                        </div>
                        <div class="form-group">
                            <label for="banheiros">Banheiros</label>
                            <input type="number" id="banheiros" name="banheiros" min="0">
                        </div>
                        <div class="form-group">
                            <label for="garagemCoberta">Garagem Coberta</label>
                            <input type="number" id="garagemCoberta" name="garagemCoberta" min="0">
                        </div>
                        <div class="form-group">
                            <label for="garagemDescoberta">Garagem Descoberta</label>
                            <input type="number" id="garagemDescoberta" name="garagemDescoberta" min="0">
                        </div>
                        <div class="form-group">
                            <label for="tipoPiso">Tipo de Piso</label>
                            <input type="text" id="tipoPiso" name="tipoPiso">
                        </div>
                        <div class="form-group">
                            <label for="tipoConstrucao">Tipo de Construção</label>
                            <input type="text" id="tipoConstrucao" name="tipoConstrucao">
                        </div>
                    </div>
                    <div class="grid grid-2">
                        <div class="checkbox-group">
                            <input type="checkbox" id="areaServico" name="areaServico" value="sim">
                            <label for="areaServico">Área de Serviço</label>
                        </div>
                        <div class="checkbox-group">
                            <input type="checkbox" id="quintal" name="quintal" value="sim">
                            <label for="quintal">Quintal</label>
                        </div>
                    </div>
                    <div class="form-group mt-4">
                        <label for="observacoes">Observações</label>
                        <textarea id="observacoes" name="observacoes" rows="3"></textarea>
                    </div>
                </div>

                <!-- Botão de Envio -->
                <div class="text-center mb-4">
                    <p class="text-muted mb-4">Ao clicar em "Avaliar Imóvel", você concorda com nossa política de privacidade.</p>
                    <button type="submit" id="submitBtn" class="btn btn-primary">
                        Avaliar Imóvel
                    </button>
                </div>
            </form>

            <!-- Resultado da Avaliação (inicialmente oculto) -->
            <div id="resultado" class="hidden">
                <h2 class="text-center">Resultado da Avaliação</h2>
                <div class="form-section">
                    <div class="grid grid-2">
                        <div class="result-card">
                            <h3>Valor de Mercado</h3>
                            <p id="valorMercado" class="result-value">R$ 0,00</p>
                        </div>
                        <div class="result-card">
                            <h3>Valor Otimista</h3>
                            <p id="valorOtimista" class="result-value">R$ 0,00</p>
                        </div>
                        <div class="result-card">
                            <h3>Valor Competitivo</h3>
                            <p id="valorCompetitivo" class="result-value">R$ 0,00</p>
                        </div>
                        <div class="result-card">
                            <h3>Valor para Locação</h3>
                            <p id="valorLocacao" class="result-value">Entre R$ 0,00 e R$ 0,00</p>
                        </div>
                    </div>
                    <div class="alert alert-info mt-4">
                        <p>Importante: Esta ferramenta fornece apenas uma estimativa inicial baseada em dados médios do mercado. Não substitui uma avaliação profissional. Para uma análise precisa do valor do seu imóvel, entre em contato com nossos corretores para agendar uma visita técnica.</p>
                    </div>
                </div>
            </div>

            <!-- Mensagem de Erro (inicialmente oculta) -->
            <div id="erro" class="hidden">
                <div class="alert alert-danger">
                    <p id="mensagemErro">
                        Não foi possível calcular a avaliação para este imóvel. Por favor, verifique os dados informados ou entre em contato conosco.
                    </p>
                    <p class="mt-4">
                        Seus dados foram enviados com sucesso para nossa equipe, que entrará em contato para uma avaliação personalizada.
                    </p>
                </div>
            </div>
        </div>

        <!-- Rodapé -->
        <footer class="footer">
            <p>&copy; 2025 Maximob Imobiliária. Todos os direitos reservados.</p>
            <p class="mt-4">
                <a href="https://www.robinsonimoveis.com.br" target="_blank" rel="noopener noreferrer">www.robinsonimoveis.com.br</a>
            </p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('avaliacaoForm');
            const loading = document.getElementById('loading');
            const resultado = document.getElementById('resultado');
            const erro = document.getElementById('erro');
            const submitBtn = document.getElementById('submitBtn');

            // Função para formatar valores em reais
            function formatarMoeda(valor) {
                return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
            }

            // Função para calcular avaliação (simulação simples)
            function calcularAvaliacao(data) {
                // Esta é uma simulação simplificada baseada em valores médios
                // Em um ambiente real, você usaria dados reais do mercado
                
                let valorBase;
                
                // Valores base por tipo de imóvel em Itapira (simulação)
                const valoresBase = {
                    'Casa': 3000,
                    'Apartamento': 4000,
                    'Terreno': 600,
                    'Chácara': 1500,
                    'Sítio': 800,
                    'Sobrado': 3500,
                    'Prédio': 4500,
                    'Área Empreendimento': 1000
                };
                
                // Fatores de ajuste por cidade (simulação)
                const fatoresCidade = {
                    'Itapira': 1.0,
                    'Campinas': 2.2,
                    'Jacutinga': 0.8,
                    'Amparo': 1.3,
                    'Mogi Mirim': 1.4,
                    'Serra Negra': 1.5
                };
                
                // Obter valor base pelo tipo de imóvel
                valorBase = valoresBase[data.tipoImovel] || 2000;
                
                // Aplicar fator de ajuste pela cidade
                const fatorCidade = fatoresCidade[data.cidade] || 1.0;
                
                // Calcular valor por m²
                const valorM2 = valorBase * fatorCidade;
                
                // Calcular valor total
                const valorTotal = valorM2 * parseFloat(data.areaConstruida);
                
                // Calcular variações
                const valorOtimista = valorTotal * 1.15;
                const valorCompetitivo = valorTotal * 0.9;
                const valorLocacaoMin = valorTotal * 0.0048;
                const valorLocacaoMax = valorTotal * 0.0058;
                
                return {
                    valorMercado: valorTotal,
                    valorOtimista: valorOtimista,
                    valorCompetitivo: valorCompetitivo,
                    valorLocacaoMin: valorLocacaoMin,
                    valorLocacaoMax: valorLocacaoMax
                };
            }

            // Função para enviar dados para WhatsApp como backup
            function enviarParaWhatsApp(data) {
                // Formatar mensagem para WhatsApp
                const mensagem = `
*NOVA AVALIAÇÃO DE IMÓVEL*

*DADOS DO SOLICITANTE:*
Nome: ${data.nome}
Email: ${data.email || 'Não informado'}
Telefone: ${data.telefone}

*DADOS DO IMÓVEL:*
Tipo: ${data.tipoImovel}
Cidade: ${data.cidade}
Bairro: ${data.bairro}
Endereço: ${data.endereco}
Área Construída: ${data.areaConstruida}m²
Área do Terreno: ${data.areaTerreno || 'Não informado'}m²

*DETALHES ADICIONAIS:*
Dormitórios: ${data.dormitorios || 'Não informado'}
Banheiros: ${data.banheiros || 'Não informado'}
Garagem Coberta: ${data.garagemCoberta || 'Não informado'}
Garagem Descoberta: ${data.garagemDescoberta || 'Não informado'}
Área de Serviço: ${data.areaServico ? 'Sim' : 'Não'}
Quintal: ${data.quintal ? 'Sim' : 'Não'}
Tipo de Piso: ${data.tipoPiso || 'Não informado'}
Tipo de Construção: ${data.tipoConstrucao || 'Não informado'}
Observações: ${data.observacoes || 'Não informado'}

Data e hora: ${new Date().toLocaleString('pt-BR')}
`;

                // Codificar mensagem para URL
                const mensagemCodificada = encodeURIComponent(mensagem);
                
                // Criar link do WhatsApp
                return `https://wa.me/5519978185219?text=${mensagemCodificada}`;
            }

            // Manipulador de envio do formulário
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Mostrar loading
                loading.classList.remove('hidden');
                
                // Coletar dados do formulário
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());
                
                // Adicionar checkboxes (que não são incluídos se não marcados)
                data.areaServico = form.querySelector('#areaServico').checked;
                data.quintal = form.querySelector('#quintal').checked;
                
                // Enviar dados para FormSubmit em segundo plano
                fetch('https://formsubmit.co/ajax/robinson@maximob.com.br', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({
                        ...data,
                        _subject: `Nova Avaliação de Imóvel - ${data.tipoImovel} em ${data.bairro}`,
                        _template: 'table',
                        _captcha: 'false'
                    })
                }).catch(err => {
                    console.error("Erro no envio de email:", err);
                    // Se falhar, criar link para WhatsApp como backup
                    const whatsappLink = enviarParaWhatsApp(data);
                    window.open(whatsappLink, '_blank');
                });
                
                // Método alternativo como backup
                fetch('https://formspree.io/f/xdoqvkzk', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                }).catch(err => console.error("Erro no método alternativo:", err));
                
                // Simular cálculo de avaliação (com chance de erro para testar fluxo de erro)
                setTimeout(() => {
                    try {
                        // 10% de chance de simular erro para testar o fluxo de erro
                        if (Math.random() < 0.1) {
                            throw new Error("Erro simulado na avaliação");
                        }
                        
                        // Calcular avaliação
                        const valores = calcularAvaliacao(data);
                        
                        // Preencher resultados
                        document.getElementById('valorMercado').textContent = formatarMoeda(valores.valorMercado);
                        document.getElementById('valorOtimista').textContent = formatarMoeda(valores.valorOtimista);
                        document.getElementById('valorCompetitivo').textContent = formatarMoeda(valores.valorCompetitivo);
                        document.getElementById('valorLocacao').textContent = `Entre ${formatarMoeda(valores.valorLocacaoMin)} e ${formatarMoeda(valores.valorLocacaoMax)}`;
                        
                        // Mostrar resultado
                        resultado.classList.remove('hidden');
                        erro.classList.add('hidden');
                    } catch (error) {
                        console.error("Erro na avaliação:", error);
                        
                        // Mostrar mensagem de erro
                        erro.classList.remove('hidden');
                        resultado.classList.add('hidden');
                        
                        // Criar link para WhatsApp como backup
                        const whatsappLink = enviarParaWhatsApp(data);
                        
                        // Adicionar botão para enviar por WhatsApp
                        const mensagemErro = document.getElementById('mensagemErro');
                        mensagemErro.innerHTML = `
                            Não foi possível calcular a avaliação para este imóvel. 
                            <a href="${whatsappLink}" target="_blank" style="color: #721c24; font-weight: 500; text-decoration: underline;">
                                Clique aqui para enviar os dados via WhatsApp
                            </a> 
                            ou aguarde nosso contato.
                        `;
                    } finally {
                        // Esconder loading
                        loading.classList.add('hidden');
                        
                        // Rolar para o resultado
                        const targetElement = resultado.classList.contains('hidden') ? erro : resultado;
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        
                        // Desabilitar botão para evitar múltiplos envios
                        submitBtn.disabled = true;
                        submitBtn.classList.add('opacity-50');
                        submitBtn.textContent = 'Avaliação Enviada';
                    }
                }, 1500); // Simular tempo de processamento
            });
        });
    </script>
</body>
</html>
